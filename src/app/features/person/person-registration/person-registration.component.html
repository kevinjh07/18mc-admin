<mat-toolbar>
  {{ person.id == null ? "Cadastrar Integrante" : "Editar Integrante" }}
  <button mat-flat-button *ngIf="person.id" style="margin-left: 1%" (click)="openLatePaymentDialog()" matTooltip="Gerenciar Pagamentos">
    <mat-icon>attach_money</mat-icon>
    Lançar Atraso Mensalidade
  </button>
  <span class="spacer"></span>
</mat-toolbar>

<div class="container" fxLayout="row" fxLayoutAlign="center none">
  <div fxFlex="95%">
    <form class="mt-10" [formGroup]="formGroup" (ngSubmit)="save()">
      <div fxLayout="row" fxLayout.lt-md="column" fxLayoutGap="20px">
        <mat-form-field [fxFlex]="50">
          <input matInput placeholder="Nome" type="text" formControlName="fullName" [(ngModel)]="person.fullName"
            maxlength="150" required />
          <mat-error *ngIf="formGroup.controls['fullName'].invalid">Campo obrigatório</mat-error>
        </mat-form-field>
      </div>

      <div fxLayout="row" fxLayout.lt-md="column" fxLayoutGap="20px">
        <mat-form-field [fxFlex]="50">
          <input matInput placeholder="Nome Colete" type="text" formControlName="shortName"
            [(ngModel)]="person.shortName" maxlength="100" required />
          <mat-error *ngIf="formGroup.controls['shortName'].invalid">Campo obrigatório</mat-error>
        </mat-form-field>
      </div>

      <div fxLayout="row" fxLayout.lt-md="column" fxLayoutGap="20px">
        <mat-form-field [fxFlex]="50">
          <mat-label>Grau Hierárquico</mat-label>
          <mat-select formControlName="hierarchyLevel" [(ngModel)]="person.hierarchyLevel" required>
            <mat-option value="XI: Camiseta">XI: Camiseta</mat-option>
            <mat-option value="X: PP">X: PP</mat-option>
            <mat-option value="IX: Meio Colete">IX: Meio Colete</mat-option>
            <mat-option value="VIII: Full">VIII: Full</mat-option>
            <mat-option value="VI: Diretor">VI: Diretor</mat-option>
            <mat-option value="VI: Sub-Diretor">VI: Sub-Diretor</mat-option>
            <mat-option value="VI: Social">VI: Social</mat-option>
            <mat-option value="VI: ADM">VI: ADM</mat-option>
            <mat-option value="VI: Sargento de Armas">VI: Sargento de Armas</mat-option>
          </mat-select>
          <mat-error *ngIf="formGroup.controls['hierarchyLevel'].invalid">Campo obrigatório</mat-error>
        </mat-form-field>
      </div>

      <div fxLayout="row" fxLayout.lt-md="column" fxLayoutGap="20px">
        <mat-form-field [fxFlex]="50">
          <mat-select
            formControlName="commandId"
            placeholder="Selecione o comando"
            (selectionChange)="getRegionals(); selectedRegionalId = 0; person.divisionId = 0"
            [(ngModel)]="selectedCommandId"
          >
            <mat-option *ngFor="let command of commands" [value]="command.id">
              {{ command.name }}
            </mat-option>
          </mat-select>
        </mat-form-field>
      </div>

      <div fxLayout="row" fxLayout.lt-md="column" fxLayoutGap="20px">
        <mat-form-field [fxFlex]="50">
          <mat-label>Regional</mat-label>
          <mat-select formControlName="regionalId" [(ngModel)]="selectedRegionalId" (selectionChange)="getDivisions()"
            required>
            <mat-option *ngFor="let regional of regionals" [value]="regional.id">{{ regional.name }}</mat-option>
          </mat-select>
          <mat-error *ngIf="formGroup.controls['regionalId'].invalid">Campo obrigatório</mat-error>
        </mat-form-field>
      </div>

      <div fxLayout="row" fxLayout.lt-md="column" fxLayoutGap="20px">
        <mat-form-field [fxFlex]="50">
          <mat-label>Divisão</mat-label>
          <mat-select formControlName="divisionId" [(ngModel)]="person.divisionId" required>
            <mat-option *ngFor="let division of divisions" [value]="division.id">{{ division.name }}</mat-option>
          </mat-select>
          <mat-error *ngIf="formGroup.controls['divisionId'].invalid">Campo obrigatório</mat-error>
        </mat-form-field>
      </div>

      <div fxLayout="row" fxLayout.lt-md="column" fxLayoutGap="20px">
        <mat-form-field [fxFlex]="50">
          <mat-label>Situação</mat-label>
          <mat-select formControlName="isActive" [(ngModel)]="person.isActive" required>
            <mat-option [value]="true">Ativo</mat-option>
            <mat-option [value]="false">Inativo</mat-option>
          </mat-select>
          <mat-error *ngIf="formGroup.controls['isActive'].invalid">Campo obrigatório</mat-error>
        </mat-form-field>
      </div>

      <div style="margin-top: 15px; margin-bottom: 15px">
        <button mat-flat-button color="primary">
          <mat-icon>save</mat-icon>
          Salvar
        </button>
        <button mat-flat-button type="button" [routerLink]="['/person']">
          <mat-icon>close</mat-icon>
          Cancelar
        </button>
      </div>
    </form>
  </div>
</div>
